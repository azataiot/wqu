
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A python package for WQU">
      
      
      
        <link rel="canonical" href="https://azgh.cc/wqu/Stochastic%20Modeling/08-reinforcement-learning/02-markov-chain/">
      
      
        <link rel="prev" href="../01-index/">
      
      
        <link rel="next" href="../03-credit-ranking-example/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Markov Chains - WQU</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


  
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
    
    
      
    
    
  
  
  <style>:root{.md-tag.md-tag--alpinejs{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22m24%2012-5.72%205.746-5.724-5.741%205.724-5.75zM5.72%206.254%200%2012l5.72%205.746h11.44z%22/%3E%3C/svg%3E');}.md-tag.md-tag--alpinelinux{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M5.998%201.607%200%2012l5.998%2010.393h12.004L24%2012%2018.002%201.607zM9.965%207.12%2012.66%209.9l1.598%201.595.002-.002%202.41%202.363q-.299.208-.563.344a4%204%200%200%201-.496.217%203%203%200%200%201-.425.111q-.196.034-.358.034-.194-.002-.338-.034a1.3%201.3%200%200%201-.24-.072%201%201%200%200%201-.2-.113l-1.062-1.092-3.039-3.041-1.1%201.053-3.07%203.072a1%201%200%200%201-.2.111%201.3%201.3%200%200%201-.237.073%201.7%201.7%200%200%201-.338.033q-.162.001-.358-.031a3%203%200%200%201-.425-.114%204%204%200%200%201-.496-.217%205%205%200%200%201-.563-.343zm4.72.785%204.579%204.598%201.382%201.353a5%205%200%200%201-.564.344%204%204%200%200%201-.494.217%203%203%200%200%201-.426.111q-.196.034-.36.034-.193-.002-.337-.034a1.3%201.3%200%200%201-.385-.146.2.2%200%200%201-.053-.04l-1.232-1.218-2.111-2.111-.334.334L12.79%209.8l1.896-1.897zm-5.966%204.12v2.529a2%202%200%200%201-.356-.035%203%203%200%200%201-.422-.116%204%204%200%200%201-.488-.214%205%205%200%200%201-.555-.34l1.82-1.825Z%22/%3E%3C/svg%3E');}.md-tag.md-tag--book{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M96%200C43%200%200%2043%200%2096v320c0%2053%2043%2096%2096%2096h320c17.7%200%2032-14.3%2032-32s-14.3-32-32-32v-64c17.7%200%2032-14.3%2032-32V32c0-17.7-14.3-32-32-32H96m0%20384h256v64H96c-17.7%200-32-14.3-32-32s14.3-32%2032-32m32-240c0-8.8%207.2-16%2016-16h192c8.8%200%2016%207.2%2016%2016s-7.2%2016-16%2016H144c-8.8%200-16-7.2-16-16m16%2048h192c8.8%200%2016%207.2%2016%2016s-7.2%2016-16%2016H144c-8.8%200-16-7.2-16-16s7.2-16%2016-16%22/%3E%3C/svg%3E');}.md-tag.md-tag--html{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20384%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22m0%2032%2034.9%20395.8L191.5%20480l157.6-52.2L384%2032zm308.2%20127.9H124.4l4.1%2049.4h175.6l-13.6%20148.4-97.9%2027v.3h-1.1l-98.7-27.3-6-75.8h47.7L138%20320l53.5%2014.5%2053.7-14.5%206-62.2H84.3L71.5%20112.2h241.1z%22/%3E%3C/svg%3E');}.md-tag.md-tag--js{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%2032v448h448V32zm243.8%20349.4c0%2043.6-25.6%2063.5-62.9%2063.5-33.7%200-53.2-17.4-63.2-38.5l34.3-20.7c6.6%2011.7%2012.6%2021.6%2027.1%2021.6%2013.8%200%2022.6-5.4%2022.6-26.5V237.7h42.1zm99.6%2063.5c-39.1%200-64.4-18.6-76.7-43l34.3-19.8c9%2014.7%2020.8%2025.6%2041.5%2025.6%2017.4%200%2028.6-8.7%2028.6-20.8%200-14.4-11.4-19.5-30.7-28l-10.5-4.5c-30.4-12.9-50.5-29.2-50.5-63.5%200-31.6%2024.1-55.6%2061.6-55.6%2026.8%200%2046%209.3%2059.8%2033.7L368%20290c-7.2-12.9-15-18-27.1-18-12.3%200-20.1%207.8-20.1%2018%200%2012.6%207.8%2017.7%2025.9%2025.6l10.5%204.5c35.8%2015.3%2055.9%2031%2055.9%2066.2%200%2037.8-29.8%2058.6-69.7%2058.6%22/%3E%3C/svg%3E');}.md-tag.md-tag--css{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22m480%2032-64%20368-223.3%2080L0%20400l19.6-94.8h82l-8%2040.6L210%20390.2l134.1-44.4%2018.8-97.1H29.5l16-82h333.7l10.5-52.7H56.3l16.3-82z%22/%3E%3C/svg%3E');}.md-tag.md-tag--python{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M439.8%20200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0%2036.8-31.2%2067.8-66.8%2067.8H172.7c-29.2%200-53.4%2025-53.4%2054.3v101.8c0%2029%2025.2%2046%2053.4%2054.3%2033.8%209.9%2066.3%2011.7%20106.8%200%2026.9-7.8%2053.4-23.5%2053.4-54.3v-40.7H226.2v-13.6h160.2c31.1%200%2042.6-21.7%2053.4-54.2%2011.2-33.5%2010.7-65.7%200-108.6M286.2%20404c11.1%200%2020.1%209.1%2020.1%2020.3%200%2011.3-9%2020.4-20.1%2020.4-11%200-20.1-9.2-20.1-20.4.1-11.3%209.1-20.3%2020.1-20.3M167.8%20248.1h106.8c29.7%200%2053.4-24.5%2053.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2%208-53.4%2024.7-53.4%2055.6v40.7h106.9v13.6h-147c-31.1%200-58.3%2018.7-66.8%2054.2-9.8%2040.7-10.2%2066.1%200%20108.6%207.6%2031.6%2025.7%2054.2%2056.8%2054.2H101v-48.8c0-35.3%2030.5-66.4%2066.8-66.4m-6.7-142.6c-11.1%200-20.1-9.1-20.1-20.3.1-11.3%209-20.4%2020.1-20.4%2011%200%2020.1%209.2%2020.1%2020.4s-9%2020.3-20.1%2020.3%22/%3E%3C/svg%3E');}.md-tag.md-tag--django{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M11.146%200h3.924v18.166c-2.013.382-3.491.535-5.096.535-4.791%200-7.288-2.166-7.288-6.32%200-4.002%202.65-6.6%206.753-6.6.637%200%201.121.05%201.707.203zm0%209.143a3.9%203.9%200%200%200-1.325-.204c-1.988%200-3.134%201.223-3.134%203.365%200%202.09%201.096%203.236%203.109%203.236.433%200%20.79-.025%201.35-.102V9.142zM21.314%206.06v9.098c0%203.134-.229%204.638-.917%205.937-.637%201.249-1.478%202.039-3.211%202.905l-3.644-1.733c1.733-.815%202.574-1.53%203.109-2.625.561-1.121.739-2.421.739-5.835V6.059zM17.39.021h3.924v4.026H17.39z%22/%3E%3C/svg%3E');}.md-tag.md-tag--postgresql{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M23.56%2014.723a.5.5%200%200%200-.057-.12q-.21-.395-1.007-.231c-1.654.34-2.294.13-2.526-.02%201.342-2.048%202.445-4.522%203.041-6.83.272-1.05.798-3.523.122-4.73a1.6%201.6%200%200%200-.15-.236C21.693.91%2019.8.025%2017.51.001c-1.495-.016-2.77.346-3.116.479a10%2010%200%200%200-.516-.082%208%208%200%200%200-1.312-.127c-1.182-.019-2.203.264-3.05.84C8.66.79%204.729-.534%202.296%201.19.935%202.153.309%203.873.43%206.304c.041.818.507%203.334%201.243%205.744q.69%202.26%201.433%203.582.83%201.493%201.714%201.79c.448.148%201.133.143%201.858-.729a56%2056%200%200%201%201.945-2.206c.435.235.906.362%201.39.377v.004a11%2011%200%200%200-.247.305c-.339.43-.41.52-1.5.745-.31.064-1.134.233-1.146.811a.6.6%200%200%200%20.091.327c.227.423.922.61%201.015.633%201.335.333%202.505.092%203.372-.679-.017%202.231.077%204.418.345%205.088.221.553.762%201.904%202.47%201.904q.375.001.829-.094c1.782-.382%202.556-1.17%202.855-2.906.15-.87.402-2.875.539-4.101.017-.07.036-.12.057-.136%200%200%20.07-.048.427.03l.044.007.254.022.015.001c.847.039%201.911-.142%202.531-.43.644-.3%201.806-1.033%201.595-1.67M2.37%2011.876c-.744-2.435-1.178-4.885-1.212-5.571-.109-2.172.417-3.683%201.562-4.493%201.837-1.299%204.84-.54%206.108-.13l-.01.01C6.795%203.734%206.843%207.226%206.85%207.44c0%20.082.006.199.016.36.034.586.1%201.68-.074%202.918-.16%201.15.194%202.276.973%203.089q.12.126.252.237c-.347.371-1.1%201.193-1.903%202.158-.568.682-.96.551-1.088.508-.392-.13-.813-.587-1.239-1.322-.48-.839-.963-2.032-1.415-3.512m6.007%205.088a1.6%201.6%200%200%201-.432-.178c.089-.039.237-.09.483-.14%201.284-.265%201.482-.451%201.915-1%20.099-.127.211-.27.367-.443a.4.4%200%200%200%20.074-.13c.17-.151.272-.11.436-.042.156.065.308.26.37.475.03.102.062.295-.045.445-.904%201.266-2.222%201.25-3.168%201.013m2.094-3.988-.052.14c-.133.357-.257.689-.334%201.004-.667-.002-1.317-.288-1.81-.803-.628-.655-.913-1.566-.783-2.5.183-1.308.116-2.447.08-3.059l-.013-.22c.296-.262%201.666-.996%202.643-.772.446.102.718.406.83.928.585%202.704.078%203.83-.33%204.736a9%209%200%200%200-.23.546m7.364%204.572q-.024.266-.062.596l-.146.438a.4.4%200%200%200-.018.108c-.006.475-.054.649-.115.87-.064.229-.135.488-.18%201.057-.11%201.414-.878%202.227-2.417%202.556-1.515.325-1.784-.496-2.02-1.221a7%207%200%200%200-.078-.227c-.215-.586-.19-1.412-.157-2.555.016-.561-.025-1.901-.33-2.646q.006-.44.019-.892a.4.4%200%200%200-.016-.113%202%202%200%200%200-.044-.208c-.122-.428-.42-.786-.78-.935-.142-.059-.403-.167-.717-.087.067-.276.183-.587.309-.925l.053-.142c.06-.16.134-.325.213-.5.426-.948%201.01-2.246.376-5.178-.237-1.098-1.03-1.634-2.232-1.51-.72.075-1.38.366-1.709.532a6%206%200%200%200-.196.104c.092-1.106.439-3.174%201.736-4.482a4%204%200%200%201%20.303-.276.35.35%200%200%200%20.145-.064c.752-.57%201.695-.85%202.802-.833q.616.01%201.174.081c1.94.355%203.244%201.447%204.036%202.383.814.962%201.255%201.931%201.431%202.454-1.323-.134-2.223.127-2.68.78-.992%201.418.544%204.172%201.282%205.496.135.242.252.452.289.54.24.583.551.972.778%201.256.07.087.138.171.189.245-.4.116-1.12.383-1.055%201.717-.013.156-.043.447-.084.815-.046.208-.07.46-.1.766m.89-1.621c-.04-.832.27-.919.597-1.01l.135-.041a1%201%200%200%200%20.134.103c.57.376%201.583.421%203.007.134-.202.177-.519.4-.953.601-.41.19-1.096.333-1.747.364-.72.034-1.086-.08-1.173-.151m.57-9.271c-.006.35-.054.669-.105%201.001-.055.358-.112.728-.127%201.177-.014.436.04.89.093%201.33.107.887.216%201.8-.207%202.701a4%204%200%200%201-.188-.385%208%208%200%200%200-.325-.617c-.616-1.104-2.057-3.69-1.32-4.744.38-.543%201.342-.566%202.179-.463m.228%207.013-.085-.107-.035-.044c.726-1.2.584-2.387.457-3.439-.052-.432-.1-.84-.088-1.222.013-.407.066-.755.118-1.092.064-.415.13-.844.111-1.35a.6.6%200%200%200%20.012-.19c-.046-.486-.6-1.938-1.73-3.253a7.8%207.8%200%200%200-2.688-2.04A9.3%209.3%200%200%201%2017.62.746c2.052.046%203.675.814%204.824%202.283a1%201%200%200%201%20.067.1c.723%201.356-.276%206.275-2.987%2010.54m-8.816-6.116c-.025.18-.31.423-.621.423a1%201%200%200%201-.081-.006.8.8%200%200%201-.506-.315c-.046-.06-.12-.178-.106-.285a.22.22%200%200%201%20.093-.149c.118-.089.352-.122.61-.086.316.044.642.193.61.418m7.93-.411c.011.08-.049.2-.153.31a.72.72%200%200%201-.408.223%201%201%200%200%201-.075.005c-.293%200-.541-.234-.56-.371-.024-.177.264-.31.56-.352.298-.042.612.009.636.185%22/%3E%3C/svg%3E');}.md-tag.md-tag--dotenv{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M24%200v24H0V0zM10.933%2015.89H6.84v5.52h4.198v-.93H7.955v-1.503h2.77v-.93h-2.77v-1.224h2.978zm2.146%200h-1.084v5.52h1.035v-3.6l2.226%203.6h1.118v-5.52h-1.036v3.686zm5.117%200h-1.208l1.973%205.52h1.19l1.976-5.52h-1.182l-1.352%204.085zM5.4%2019.68H3.72v1.68H5.4z%22/%3E%3C/svg%3E');}.md-tag.md-tag--git{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M439.55%20236.05%20244%2040.45a28.87%2028.87%200%200%200-40.81%200l-40.66%2040.63%2051.52%2051.52c27.06-9.14%2052.68%2016.77%2043.39%2043.68l49.66%2049.66c34.23-11.8%2061.18%2031%2035.47%2056.69-26.49%2026.49-70.21-2.87-56-37.34L240.22%20199v121.85c25.3%2012.54%2022.26%2041.85%209.08%2055a34.34%2034.34%200%200%201-48.55%200c-17.57-17.6-11.07-46.91%2011.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57%20101%208.45%20235.14a28.86%2028.86%200%200%200%200%2040.81l195.61%20195.6a28.86%2028.86%200%200%200%2040.8%200l194.69-194.69a28.86%2028.86%200%200%200%200-40.81%22/%3E%3C/svg%3E');}.md-tag.md-tag--github{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20496%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M165.9%20397.4c0%202-2.3%203.6-5.2%203.6-3.3.3-5.6-1.3-5.6-3.6%200-2%202.3-3.6%205.2-3.6%203-.3%205.6%201.3%205.6%203.6m-31.1-4.5c-.7%202%201.3%204.3%204.3%204.9%202.6%201%205.6%200%206.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2%202.3m44.2-1.7c-2.9.7-4.9%202.6-4.6%204.9.3%202%202.9%203.3%205.9%202.6%202.9-.7%204.9-2.6%204.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8%208C106.1%208%200%20113.3%200%20252c0%20110.9%2069.8%20205.8%20169.5%20239.2%2012.8%202.3%2017.3-5.6%2017.3-12.1%200-6.2-.3-40.4-.3-61.4%200%200-70%2015-84.7-29.8%200%200-11.4-29.1-27.8-36.6%200%200-22.9-15.7%201.6-15.4%200%200%2024.9%202%2038.6%2025.8%2021.9%2038.6%2058.6%2027.5%2072.9%2020.9%202.3-16%208.8-27.1%2016-33.7-55.9-6.2-112.3-14.3-112.3-110.5%200-27.5%207.6-41.3%2023.6-58.9-2.6-6.5-11.1-33.3%202.6-67.9%2020.9-6.5%2069%2027%2069%2027%2020-5.6%2041.5-8.5%2062.8-8.5s42.8%202.9%2062.8%208.5c0%200%2048.1-33.6%2069-27%2013.7%2034.7%205.2%2061.4%202.6%2067.9%2016%2017.7%2025.8%2031.5%2025.8%2058.9%200%2096.5-58.9%20104.2-114.8%20110.5%209.2%207.9%2017%2022.9%2017%2046.4%200%2033.7-.3%2075.4-.3%2083.6%200%206.5%204.6%2014.4%2017.3%2012.1C428.2%20457.8%20496%20362.9%20496%20252%20496%20113.3%20383.5%208%20244.8%208M97.2%20352.9c-1.3%201-1%203.3.7%205.2%201.6%201.6%203.9%202.3%205.2%201%201.3-1%201-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7%201.3.3%202.9%202.3%203.9%201.6%201%203.6.7%204.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4%2035.6c-1.6%201.3-1%204.3%201.3%206.2%202.3%202.3%205.2%202.6%206.5%201%201.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6%201-1.6%203.6%200%205.9s4.3%203.3%205.6%202.3c1.6-1.3%201.6-3.9%200-6.2-1.4-2.3-4-3.3-5.6-2%22/%3E%3C/svg%3E');}.md-tag.md-tag--docker{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M349.9%20236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2%20144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1%200h-66.1v60.1h66.1zm276.8%20100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3%2014c-18.4%2027.8-23.4%2073.6-3.7%20103.8-8.7%204.7-25.8%2011.1-48.4%2010.7H2.4c-8.7%2050.8%205.8%20116.8%2044%20162.1%2037.1%2043.9%2092.7%2066.2%20165.4%2066.2%20157.4%200%20273.9-72.5%20328.4-204.2%2021.4.4%2067.6.1%2091.3-45.2%201.5-2.5%206.6-13.2%208.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1%200h-66.1v59.4h66.1zm78.1%200h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z%22/%3E%3C/svg%3E');}.md-tag.md-tag--celery{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M2.303%200A2.3%202.3%200%200%200%200%202.303v19.394A2.3%202.3%200%200%200%202.303%2024h19.394A2.3%202.3%200%200%200%2024%2021.697V2.303A2.3%202.3%200%200%200%2021.697%200zm8.177%203.072c4.098%200%207.028%201.438%207.68%201.764l-1.194%202.55c-2.442-1.057-4.993-1.41-5.672-1.41-1.574%200-2.17.922-2.17%201.763v8.494c0%20.869.596%201.791%202.17%201.791.679%200%203.23-.38%205.672-1.41l1.194%202.496c-.435.271-3.637%201.818-7.68%201.818-1.112%200-4.64-.244-4.64-4.64V7.713c0-4.397%203.528-4.64%204.64-4.64z%22/%3E%3C/svg%3E');}.md-tag.md-tag--htmx{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M0%2013.01v-2l7.09-2.98.58%201.94-5.1%202.05%205.16%202.05-.63%201.9Zm16.37%201.03%205.18-2-5.16-2.09.65-1.88L24%2010.95v2.12L17%2016zm-2.85-9.98H16l-5.47%2015.88H8.05Z%22/%3E%3C/svg%3E');}.md-tag.md-tag--timescale{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M5.537.763c-1.167.7-2.21%201.582-3.08%202.61L3.79%204.836a10.4%2010.4%200%200%201%203.627-2.881zm13.028.085-1.991%201.12a10.4%2010.4%200%200%201%203.762%203.07l1.18-1.654a12.4%2012.4%200%200%200-2.95-2.536zm-6.564.752a9.8%209.8%200%200%200-4.131.91l.59%201.011a8.5%208.5%200%200%201%203.541-.762c1.261%200%202.457.274%203.534.76l.59-1.012a9.8%209.8%200%200%200-4.124-.907M11.4%203.535l-.55%206.626h.003l-.002.04q.004.166.033.318.015.169.097.342c.114.289.298.505.516.607q.077.058.158.111l.033.02v.004l6.68%203.596.348-.476-6.058-4.6q-.01-.002-.014-.008L12%203.535zm1.423.052c.19.234.361.523.502.855%203.155.604%205.54%203.325%205.54%206.596%200%20.877-.176%201.712-.484%202.48a3.7%203.7%200%200%201%20.52.76%207.3%207.3%200%200%200%20.754-3.24c0-3.868-2.99-7.05-6.832-7.45zm-2.284.095c-3.527.667-6.19%203.708-6.19%207.356%200%202.584%201.335%204.863%203.367%206.21a10%2010%200%200%201%20.295-.743c-1.74-1.219-2.874-3.214-2.874-5.467%200-3.054%202.082-5.632%204.932-6.45a3.7%203.7%200%200%201%20.47-.906m9.15%201.675-.801.893a8.1%208.1%200%200%201%201.551%204.777c0%202.916-1.542%205.481-3.872%206.952q.156.583.251%201.209c2.87-1.632%204.802-4.677%204.802-8.16a9.22%209.22%200%200%200-1.93-5.67zm-15.38.007a9.25%209.25%200%200%200-1.93%205.665c0%203.507%201.954%206.567%204.858%208.19q.093-.629.248-1.206c-2.36-1.468-3.923-4.045-3.923-6.984%200-1.777.573-3.422%201.549-4.772zm9.314.043q.066.304.107.64a5.33%205.33%200%200%201%203.213%202.912l.577-.148a5.94%205.94%200%200%200-3.897-3.404m-3.816.187a5.94%205.94%200%200%200-3.319%203.198l.58.148A5.32%205.32%200%200%201%209.73%206.257q.023-.342.077-.663M6.733%209.672l-.62.63.315.614%201.727.618.942-.618-.312-.923zm10.615%200-2.048.321-.315.923.942.618%201.73-.618.315-.614zM6.1%2011.869A5.82%205.82%200%200%200%208.42%2015.7q.15-.256.315-.493a5.25%205.25%200%200%201-2.038-3.34zm11.206%200q-.046.269-.118.529.26.205.493.41c.097-.302.174-.617.22-.94zm-15.679.217L0%2014.158c.966%203.661%203.638%206.65%207.132%208.111a9%209%200%200%201-.05-1.031q0-.564.05-1.111c-3.024-1.563-5.166-4.544-5.505-8.041m20.707.055c-.352%203.45-2.464%206.394-5.441%207.957q.049.563.053%201.136%200%20.564-.05%201.005c3.506-1.488%206.175-4.522%207.104-8.223zm-6.544%202.617a5%205%200%200%201-.486.42q.167.237.318.493.399-.3.74-.66a11%2011%200%200%201-.572-.253m1.502.559a7%207%200%200%201-1.25%201.156c.106.236.207.485.294.741a7.7%207.7%200%200%200%201.857-1.772%203.6%203.6%200%200%201-.9-.125zm-2.988.63-2.303.913-2.307-.91-.587%201.435%202.448.946c-.134.46-.568.798-1.08.798q-.052-.001-.104-.007l-.5.686q.284.095.6.096a1.92%201.92%200%200%200%201.52-.738%201.92%201.92%200%200%200%202.183.62l-.49-.67a1.12%201.12%200%200%201-1.26-.805l2.47-.926zm1.156%204.775c-1.09.377-2.256.58-3.476.58-1.17%200-2.29-.186-3.34-.534.231.88.59%201.654%201.05%202.262a12.683%2012.683%200%200%200%204.731-.029c.453-.61.807-1.39%201.035-2.28z%22/%3E%3C/svg%3E');}.md-tag.md-tag--rabbitmq{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M23.035%209.601h-7.677a.956.956%200%200%201-.962-.962V.962a.956.956%200%200%200-.962-.956H10.56a.956.956%200%200%200-.962.956V8.64a.956.956%200%200%201-.962.962H5.762a.956.956%200%200%201-.961-.962V.962A.956.956%200%200%200%203.839%200H.959a.956.956%200%200%200-.956.962v22.076A.956.956%200%200%200%20.965%2024h22.07a.956.956%200%200%200%20.962-.962V10.58a.956.956%200%200%200-.962-.98zm-3.86%208.152a1.437%201.437%200%200%201-1.437%201.443h-1.924a1.437%201.437%200%200%201-1.436-1.443v-1.917a1.437%201.437%200%200%201%201.436-1.443h1.924a1.437%201.437%200%200%201%201.437%201.443z%22/%3E%3C/svg%3E');}.md-tag.md-tag--redis{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M22.71%2013.145c-1.66%202.092-3.452%204.483-7.038%204.483-3.203%200-4.397-2.825-4.48-5.12.701%201.484%202.073%202.685%204.214%202.63%204.117-.133%206.94-3.852%206.94-7.239%200-4.05-3.022-6.972-8.268-6.972-3.752%200-8.4%201.428-11.455%203.685C2.59%206.937%203.885%209.958%204.35%209.626c2.648-1.904%204.748-3.13%206.784-3.744C8.12%209.244.886%2017.05%200%2018.425c.1%201.261%201.66%204.648%202.424%204.648.232%200%20.431-.133.664-.365a101%20101%200%200%200%205.54-6.765c.222%203.104%201.748%206.898%206.014%206.898%203.819%200%207.604-2.756%209.33-8.965.2-.764-.73-1.361-1.261-.73zm-4.349-5.013c0%201.959-1.926%202.922-3.685%202.922a4.45%204.45%200%200%201-2.235-.568c1.051-1.592%202.092-3.225%203.21-4.973%201.972.334%202.71%201.43%202.71%202.619%22/%3E%3C/svg%3E');}.md-tag.md-tag--sentry{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M13.91%202.505c-.873-1.448-2.972-1.448-3.844%200L6.904%207.92a15.48%2015.48%200%200%201%208.53%2012.811h-2.221A13.3%2013.3%200%200%200%205.784%209.814l-2.926%205.06a7.65%207.65%200%200%201%204.435%205.848H2.194a.365.365%200%200%201-.298-.534l1.413-2.402a5.2%205.2%200%200%200-1.614-.913L.296%2019.275a2.18%202.18%200%200%200%20.812%202.999%202.24%202.24%200%200%200%201.086.288h6.983a9.32%209.32%200%200%200-3.845-8.318l1.11-1.922a11.47%2011.47%200%200%201%204.95%2010.24h5.915a17.24%2017.24%200%200%200-7.885-15.28l2.244-3.845a.37.37%200%200%201%20.504-.13c.255.14%209.75%2016.708%209.928%2016.9a.365.365%200%200%201-.327.543h-2.287q.043.918%200%201.831h2.297a2.206%202.206%200%200%200%201.922-3.31z%22/%3E%3C/svg%3E');}.md-tag.md-tag--ubuntu{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M17.61.455a3.41%203.41%200%200%200-3.41%203.41%203.41%203.41%200%200%200%203.41%203.41%203.41%203.41%200%200%200%203.41-3.41%203.41%203.41%200%200%200-3.41-3.41M12.92.8C8.923.777%205.137%202.941%203.148%206.451a5%205%200%200%201%20.26-.007%204.9%204.9%200%200%201%202.585.737A8.32%208.32%200%200%201%2012.688%203.6%204.94%204.94%200%200%201%2013.723.834%2011%2011%200%200%200%2012.92.8m9.226%204.994a4.9%204.9%200%200%201-1.918%202.246%208.36%208.36%200%200%201-.273%208.303%204.9%204.9%200%200%201%201.632%202.54%2011.16%2011.16%200%200%200%20.559-13.089M3.41%207.932A3.41%203.41%200%200%200%200%2011.342a3.41%203.41%200%200%200%203.41%203.409%203.41%203.41%200%200%200%203.41-3.41%203.41%203.41%200%200%200-3.41-3.41zm2.027%207.866a4.9%204.9%200%200%201-2.915.358%2011.1%2011.1%200%200%200%207.991%206.698%2011.2%2011.2%200%200%200%202.422.249%204.88%204.88%200%200%201-.999-2.85%209%209%200%200%201-.836-.136%208.3%208.3%200%200%201-5.663-4.32zm11.405.928a3.41%203.41%200%200%200-3.41%203.41%203.41%203.41%200%200%200%203.41%203.41%203.41%203.41%200%200%200%203.41-3.41%203.41%203.41%200%200%200-3.41-3.41%22/%3E%3C/svg%3E');}.md-tag.md-tag--debian{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M13.88%2012.685c-.4%200%20.08.2.601.28.14-.1.27-.22.39-.33a3%203%200%200%201-.99.05m2.14-.53c.23-.33.4-.69.47-1.06-.06.27-.2.5-.33.73-.75.47-.07-.27%200-.56-.8%201.01-.11.6-.14.89m.781-2.05c.05-.721-.14-.501-.2-.221.07.04.13.5.2.22M12.38.31c.2.04.45.07.42.12.23-.05.28-.1-.43-.12m.43.12-.15.03.14-.01V.43m6.633%209.944c.02.64-.2.95-.38%201.5l-.35.181c-.28.54.03.35-.17.78-.44.39-1.34%201.22-1.62%201.301-.201%200%20.14-.25.19-.34-.591.4-.481.6-1.371.85l-.03-.06c-2.221%201.04-5.303-1.02-5.253-3.842-.03.17-.07.13-.12.2a3.55%203.55%200%200%201%202.001-3.501%203.36%203.36%200%200%201%203.732.48%203.34%203.34%200%200%200-2.721-1.3c-1.18.01-2.281.76-2.651%201.57-.6.38-.67%201.47-.93%201.661-.361%202.601.66%203.722%202.38%205.042.27.19.08.21.12.35a4.7%204.7%200%200%201-1.53-1.16c.23.33.47.66.8.91-.55-.18-1.27-1.3-1.48-1.35.93%201.66%203.78%202.921%205.261%202.3a6.2%206.2%200%200%201-2.33-.28c-.33-.16-.77-.51-.7-.57a5.802%205.803%200%200%200%205.902-.84c.44-.35.93-.94%201.07-.95-.2.32.04.16-.12.44.44-.72-.2-.3.46-1.24l.24.33c-.09-.6.74-1.321.66-2.262.19-.3.2.3%200%20.97.29-.74.08-.85.15-1.46.08.2.18.42.23.63-.18-.7.2-1.2.28-1.6-.09-.05-.28.3-.32-.53%200-.37.1-.2.14-.28-.08-.05-.26-.32-.38-.861.08-.13.22.33.34.34-.08-.42-.2-.75-.2-1.08-.34-.68-.12.1-.4-.3-.34-1.091.3-.25.34-.74.54.77.84%201.96.981%202.46-.1-.6-.28-1.2-.49-1.76.16.07-.26-1.241.21-.37A7.82%207.82%200%200%200%2017.702%201.6c.18.17.42.39.33.42-.75-.45-.62-.48-.73-.67-.61-.25-.65.02-1.06%200C15.082.73%2014.862.8%2013.8.4l.05.23c-.77-.25-.9.1-1.73%200-.05-.04.27-.14.53-.18-.741.1-.701-.14-1.431.03.17-.13.36-.21.55-.32-.6.04-1.44.35-1.18.07C9.6.68%207.847%201.3%206.867%202.22L6.838%202c-.45.54-1.96%201.611-2.08%202.311l-.131.03c-.23.4-.38.85-.57%201.261-.3.52-.45.2-.4.28-.6%201.22-.9%202.251-1.16%203.102.18.27%200%201.65.07%202.76-.3%205.463%203.84%2010.776%208.363%2012.006.67.23%201.65.23%202.49.25-.99-.28-1.12-.15-2.08-.49-.7-.32-.85-.7-1.34-1.13l.2.35c-.971-.34-.57-.42-1.361-.67l.21-.27c-.31-.03-.83-.53-.97-.81l-.34.01c-.41-.501-.63-.871-.61-1.161l-.111.2c-.13-.21-1.52-1.901-.8-1.511-.13-.12-.31-.2-.5-.55l.14-.17c-.35-.44-.64-1.02-.62-1.2.2.24.32.3.45.33-.88-2.172-.93-.12-1.601-2.202l.15-.02c-.1-.16-.18-.34-.26-.51l.06-.6c-.63-.74-.18-3.102-.09-4.402.07-.54.53-1.1.88-1.981l-.21-.04c.4-.71%202.341-2.872%203.241-2.761.43-.55-.09%200-.18-.14.96-.991%201.26-.7%201.901-.88.7-.401-.6.16-.27-.151%201.2-.3.85-.7%202.421-.85.16.1-.39.14-.52.26%201-.49%203.151-.37%204.562.27%201.63.77%203.461%203.011%203.531%205.132l.08.02c-.04.85.13%201.821-.17%202.711l.2-.42M9.54%2013.236l-.05.28c.26.35.47.73.8%201.01-.24-.47-.42-.66-.75-1.3m.62-.02c-.14-.15-.22-.34-.31-.52.08.32.26.6.43.88zm10.945-2.382-.07.15c-.1.76-.34%201.511-.69%202.212.4-.73.65-1.541.75-2.362M12.45.12c.27-.1.66-.05.95-.12-.37.03-.74.05-1.1.1zM3.006%205.142c.07.57-.43.8.11.42.3-.66-.11-.18-.1-.42m-.64%202.661c.12-.39.15-.62.2-.84-.35.44-.17.53-.2.83%22/%3E%3C/svg%3E');}.md-tag.md-tag--shop{--md-tag-icon:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%206.7.2%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202024%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M36.8%20192h566.3c20.3%200%2036.8-16.5%2036.8-36.8%200-7.3-2.2-14.4-6.2-20.4L558.2%2021.4C549.3%208%20534.4%200%20518.3%200H121.7c-16%200-31%208-39.9%2021.4L6.2%20134.7c-4%206.1-6.2%2013.2-6.2%2020.4C0%20175.5%2016.5%20192%2036.8%20192M64%20224v240c0%2026.5%2021.5%2048%2048%2048h224c26.5%200%2048-21.5%2048-48V224h-64v160H128V224zm448%200v256c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32V224z%22/%3E%3C/svg%3E');}}</style>

    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#markov-chains" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="WQU" class="md-header__button md-logo" aria-label="WQU" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 80c0 18-14.3 34.6-38.4 48-29.1 16.1-72.5 27.5-122.3 30.9-3.7-1.8-7.4-3.5-11.3-5-39.4-16.5-91.8-25.9-148-25.9-8.3 0-16.4.2-24.5.6l-1.1-.6C142.3 114.6 128 98 128 80c0-44.2 86-80 192-80s192 35.8 192 80m-351.3 81.1c10.2-.7 20.7-1.1 31.3-1.1 62.2 0 117.4 12.3 152.5 31.4 24.8 13.5 39.5 30.3 39.5 48.6q0 6-2.1 11.7c-4.6 13.2-17 25.3-35 35.5-.1.1-.3.1-.4.2-.3.2-.6.3-.9.5-35 19.4-90.8 32-153.6 32-59.6 0-112.9-11.3-148.2-29.1-1.9-.9-3.7-1.9-5.5-2.9C14.3 274.6 0 258 0 240c0-34.8 53.4-64.5 128-75.4 10.5-1.5 21.4-2.7 32.7-3.5M416 240c0-21.9-10.6-39.9-24.1-53.4 28.3-4.4 54.2-11.4 76.2-20.5 16.3-6.8 31.5-15.2 43.9-25.5V176c0 19.3-16.5 37.1-43.8 50.9-14.6 7.4-32.4 13.7-52.4 18.5.1-1.8.2-3.5.2-5.3zm-32 96c0 18-14.3 34.6-38.4 48-1.8 1-3.6 1.9-5.5 2.9C304.9 404.7 251.6 416 192 416c-62.8 0-118.6-12.6-153.6-32C14.3 370.6 0 354 0 336v-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 342.6 135.8 352 192 352s108.6-9.4 148.1-25.9c7.8-3.2 15.3-6.9 22.4-10.9 6.1-3.4 11.8-7.2 17.2-11.2 1.5-1.1 2.9-2.3 4.3-3.4V336m32 0v-57.9c19-4.2 36.5-9.5 52.1-16 16.3-6.8 31.5-15.2 43.9-25.5V272c0 10.5-5 21-14.9 30.9-16.3 16.3-45 29.7-81.3 38.4.1-1.7.2-3.5.2-5.3M192 448c56.2 0 108.6-9.4 148.1-25.9 16.3-6.8 31.5-15.2 43.9-25.5V432c0 44.2-86 80-192 80S0 476.2 0 432v-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 438.6 135.8 448 192 448"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            WQU
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Markov Chains
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Welcome to wqu

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Derivative%20Pricing/01-index/" class="md-tabs__link">
          
  
  
  Derivative Pricing

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../FAQs/other/" class="md-tabs__link">
          
  
  
  FAQs

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../01-index/" class="md-tabs__link">
          
  
  
  Stochastic Modeling

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="WQU" class="md-nav__button md-logo" aria-label="WQU" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M512 80c0 18-14.3 34.6-38.4 48-29.1 16.1-72.5 27.5-122.3 30.9-3.7-1.8-7.4-3.5-11.3-5-39.4-16.5-91.8-25.9-148-25.9-8.3 0-16.4.2-24.5.6l-1.1-.6C142.3 114.6 128 98 128 80c0-44.2 86-80 192-80s192 35.8 192 80m-351.3 81.1c10.2-.7 20.7-1.1 31.3-1.1 62.2 0 117.4 12.3 152.5 31.4 24.8 13.5 39.5 30.3 39.5 48.6q0 6-2.1 11.7c-4.6 13.2-17 25.3-35 35.5-.1.1-.3.1-.4.2-.3.2-.6.3-.9.5-35 19.4-90.8 32-153.6 32-59.6 0-112.9-11.3-148.2-29.1-1.9-.9-3.7-1.9-5.5-2.9C14.3 274.6 0 258 0 240c0-34.8 53.4-64.5 128-75.4 10.5-1.5 21.4-2.7 32.7-3.5M416 240c0-21.9-10.6-39.9-24.1-53.4 28.3-4.4 54.2-11.4 76.2-20.5 16.3-6.8 31.5-15.2 43.9-25.5V176c0 19.3-16.5 37.1-43.8 50.9-14.6 7.4-32.4 13.7-52.4 18.5.1-1.8.2-3.5.2-5.3zm-32 96c0 18-14.3 34.6-38.4 48-1.8 1-3.6 1.9-5.5 2.9C304.9 404.7 251.6 416 192 416c-62.8 0-118.6-12.6-153.6-32C14.3 370.6 0 354 0 336v-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 342.6 135.8 352 192 352s108.6-9.4 148.1-25.9c7.8-3.2 15.3-6.9 22.4-10.9 6.1-3.4 11.8-7.2 17.2-11.2 1.5-1.1 2.9-2.3 4.3-3.4V336m32 0v-57.9c19-4.2 36.5-9.5 52.1-16 16.3-6.8 31.5-15.2 43.9-25.5V272c0 10.5-5 21-14.9 30.9-16.3 16.3-45 29.7-81.3 38.4.1-1.7.2-3.5.2-5.3M192 448c56.2 0 108.6-9.4 148.1-25.9 16.3-6.8 31.5-15.2 43.9-25.5V432c0 44.2-86 80-192 80S0 476.2 0 432v-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 438.6 135.8 448 192 448"/></svg>

    </a>
    WQU
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome to wqu
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../Derivative%20Pricing/01-index/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Derivative Pricing
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../FAQs/other/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    FAQs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Stochastic Modeling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Stochastic Modeling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01-index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stochastic Modeling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../02-fourier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fourier-Based Option Pricing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03-cf-blacksholes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Black-Scholes Characteristic Function(CF)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04-fourier-transform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fourier-Based option pricing (BS)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05-heston/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fourier Methods for Heston Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../06-merton/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Merton Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../07-bates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bates Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" checked>
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    08 reinforcement learning
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            08 reinforcement learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reinforcement Learning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Markov Chains
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Markov Chains
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tldr" class="md-nav__link">
    <span class="md-ellipsis">
      TL;DR
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      Intro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Intro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-concepts-with-analogies-credit-rating" class="md-nav__link">
    <span class="md-ellipsis">
      Core Concepts with Analogies (Credit Rating)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transition-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Transition Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stationary-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      Stationary Distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estimating-transition-probabilities-from-data" class="md-nav__link">
    <span class="md-ellipsis">
      Estimating Transition Probabilities from Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#absorbing-states" class="md-nav__link">
    <span class="md-ellipsis">
      Absorbing States
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizing-a-markov-chain-with-credit-ratings" class="md-nav__link">
    <span class="md-ellipsis">
      Visualizing a Markov Chain with Credit Ratings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stationary-distribution_1" class="md-nav__link">
    <span class="md-ellipsis">
      Stationary Distribution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simplification" class="md-nav__link">
    <span class="md-ellipsis">
      Simplification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simplification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-2-state-weather-model" class="md-nav__link">
    <span class="md-ellipsis">
      A 2-State Weather Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-credit-ratings" class="md-nav__link">
    <span class="md-ellipsis">
      Application: Credit Ratings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-matrix-wise-intuition-for-credit-rating-as-a-markov-chain" class="md-nav__link">
    <span class="md-ellipsis">
      A matrix wise intuition for Credit Rating As a Markov Chain
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A matrix wise intuition for Credit Rating As a Markov Chain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#organize-the-probabilities-in-a-table-from-scalars-to-grid" class="md-nav__link">
    <span class="md-ellipsis">
      Organize the Probabilities in a Table (From Scalars to Grid)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turn-that-table-into-a-transition-matrix-p" class="md-nav__link">
    <span class="md-ellipsis">
      Turn That Table Into a Transition Matrix P
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#one-step-probability-as-a-matrix-dot-product" class="md-nav__link">
    <span class="md-ellipsis">
      One-Step Probability as a Matrix Dot Product
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#now-try-2-years-multiply-again" class="md-nav__link">
    <span class="md-ellipsis">
      Now Try 2 Years  Multiply Again
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#general-rule" class="md-nav__link">
    <span class="md-ellipsis">
      General Rule
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summarization" class="md-nav__link">
    <span class="md-ellipsis">
      Summarization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summarization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-2-state-homogeneous-markov-chain" class="md-nav__link">
    <span class="md-ellipsis">
      A 2-State Homogeneous Markov Chain
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    <span class="md-ellipsis">
      Code
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-credit-ranking-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Credit Ranking Markov Chain Example
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    09 dynamic programming
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            09 dynamic programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../09-dynamic%20programming/01-dynamic-programming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dynamic Programming
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tldr" class="md-nav__link">
    <span class="md-ellipsis">
      TL;DR
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      Intro
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Intro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-concepts-with-analogies-credit-rating" class="md-nav__link">
    <span class="md-ellipsis">
      Core Concepts with Analogies (Credit Rating)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transition-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      Transition Matrix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stationary-distribution" class="md-nav__link">
    <span class="md-ellipsis">
      Stationary Distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estimating-transition-probabilities-from-data" class="md-nav__link">
    <span class="md-ellipsis">
      Estimating Transition Probabilities from Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#absorbing-states" class="md-nav__link">
    <span class="md-ellipsis">
      Absorbing States
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizing-a-markov-chain-with-credit-ratings" class="md-nav__link">
    <span class="md-ellipsis">
      Visualizing a Markov Chain with Credit Ratings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stationary-distribution_1" class="md-nav__link">
    <span class="md-ellipsis">
      Stationary Distribution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simplification" class="md-nav__link">
    <span class="md-ellipsis">
      Simplification
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simplification">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-2-state-weather-model" class="md-nav__link">
    <span class="md-ellipsis">
      A 2-State Weather Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#application-credit-ratings" class="md-nav__link">
    <span class="md-ellipsis">
      Application: Credit Ratings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-matrix-wise-intuition-for-credit-rating-as-a-markov-chain" class="md-nav__link">
    <span class="md-ellipsis">
      A matrix wise intuition for Credit Rating As a Markov Chain
    </span>
  </a>
  
    <nav class="md-nav" aria-label="A matrix wise intuition for Credit Rating As a Markov Chain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#organize-the-probabilities-in-a-table-from-scalars-to-grid" class="md-nav__link">
    <span class="md-ellipsis">
      Organize the Probabilities in a Table (From Scalars to Grid)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turn-that-table-into-a-transition-matrix-p" class="md-nav__link">
    <span class="md-ellipsis">
      Turn That Table Into a Transition Matrix P
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#one-step-probability-as-a-matrix-dot-product" class="md-nav__link">
    <span class="md-ellipsis">
      One-Step Probability as a Matrix Dot Product
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#now-try-2-years-multiply-again" class="md-nav__link">
    <span class="md-ellipsis">
      Now Try 2 Years  Multiply Again
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#general-rule" class="md-nav__link">
    <span class="md-ellipsis">
      General Rule
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summarization" class="md-nav__link">
    <span class="md-ellipsis">
      Summarization
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summarization">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-2-state-homogeneous-markov-chain" class="md-nav__link">
    <span class="md-ellipsis">
      A 2-State Homogeneous Markov Chain
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    <span class="md-ellipsis">
      Code
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="markov-chains">Markov Chains<a class="headerlink" href="#markov-chains" title="Permanent link">&para;</a></h1>
<h2 id="tldr">TL;DR<a class="headerlink" href="#tldr" title="Permanent link">&para;</a></h2>
<p>A Markov Chain is a model where you move between states, and your next move depends only on where you are now. We use a transition matrix to represent the rules, and sometimes the system settles into a long-term distribution called the <strong>stationary distribution</strong>. In finance, this is super useful for modeling <strong>credit rating transitions</strong>, especially with <strong>absorbing states</strong> like default.</p>
<h2 id="intro">Intro<a class="headerlink" href="#intro" title="Permanent link">&para;</a></h2>
<p>Imagine a simple board game where you throw a dice , and depending on the result, you move to a different square. Each square has arrow showing where you might land next - based only on <strong>where you are now</strong>, not how you got there. </p>
<p>This is the idea of a Markov Chain. </p>
<blockquote>
<p>A Markov Chain is a system that moves between states, and the next move depdns only on the current state, not the full history.</p>
</blockquote>
<p><img alt="ChatGPT Image Apr 17, 2025 at 01_15_09 PM" src="../assets/markov-chains.png" /></p>
<h3 id="core-concepts-with-analogies-credit-rating">Core Concepts with Analogies (Credit Rating)<a class="headerlink" href="#core-concepts-with-analogies-credit-rating" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th><strong>Concept</strong></th>
<th><strong>Meaning</strong></th>
<th><strong>Analogy</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>State</strong></td>
<td>A situation or status (e.g., credit rating AA)</td>
<td>Square on the board</td>
</tr>
<tr>
<td><strong>Transition</strong></td>
<td>Moving from one state to another</td>
<td>Rolling a die and moving forward</td>
</tr>
<tr>
<td><strong>Transition matrix</strong></td>
<td>Table showing the probabilities of moving from one state to another</td>
<td>Rules for dice outcomes</td>
</tr>
<tr>
<td><strong>Stationary distribution</strong></td>
<td>Long-term behavior: how often you land on each state</td>
<td>Where youll spend most of your time</td>
</tr>
<tr>
<td><strong>Absorbing state</strong></td>
<td>A state that, once entered, you never leave (like default)</td>
<td>A square that ends the game</td>
</tr>
</tbody>
</table>
<p><img alt="img" src="../assets/112-crat.png" /></p>
<h3 id="transition-matrix">Transition Matrix<a class="headerlink" href="#transition-matrix" title="Permanent link">&para;</a></h3>
<p>Lets say you have <span class="arithmatex">\(N\)</span> states. The matrix <span class="arithmatex">\(P\)</span> of transition probabilities looks like this:</p>
<div class="arithmatex">\[
P =
\begin{bmatrix}
p_{11} &amp; p_{12} &amp; \cdots &amp; p_{1N} \\
p_{21} &amp; p_{22} &amp; \cdots &amp; p_{2N} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
p_{N1} &amp; p_{N2} &amp; \cdots &amp; p_{NN} \\
\end{bmatrix}
\]</div>
<p>And each row must sum to 1:</p>
<div class="arithmatex">\[
\sum_{j=1}^{N} p_{ij} = 1 \quad \text{for all } i
\]</div>
<h3 id="stationary-distribution">Stationary Distribution<a class="headerlink" href="#stationary-distribution" title="Permanent link">&para;</a></h3>
<p>As time goes on, the Markov chain might settle into a pattern where it spends time in states according to a fixed distribution <span class="arithmatex">\(\pi\)</span>:</p>
<div class="arithmatex">\[
\pi = \pi P
\quad \text{where} \quad \sum_{k=1}^{N} \pi_k = 1, \quad \pi_k \geq 0
\]</div>
<p>This means if you start with <span class="arithmatex">\(\pi\)</span>, applying the matrix dosent change it  its a fixed point. </p>
<h3 id="estimating-transition-probabilities-from-data">Estimating Transition Probabilities from Data<a class="headerlink" href="#estimating-transition-probabilities-from-data" title="Permanent link">&para;</a></h3>
<p>If you observe a lot of transitions, you can build a frequency table. Suppose: </p>
<ul>
<li><span class="arithmatex">\(n_{ij}\)</span>: number of times we observe a transition from state <span class="arithmatex">\(i\)</span> to state <span class="arithmatex">\(j\)</span> </li>
</ul>
<p>Then the maximum likelihood estimator is:</p>
<div class="arithmatex">\[
\hat{p}{ij} = \frac{n{ij}}{\sum_{k=1}^{N} n_{ik}}
\]</div>
<h3 id="absorbing-states">Absorbing States<a class="headerlink" href="#absorbing-states" title="Permanent link">&para;</a></h3>
<p>A state is absorbing if: <span class="arithmatex">\(p_{ii} = 1\)</span>, meaning  once you enter it, you stay there. In finance, default is modeled this way. </p>
<h3 id="visualizing-a-markov-chain-with-credit-ratings">Visualizing a Markov Chain with Credit Ratings<a class="headerlink" href="#visualizing-a-markov-chain-with-credit-ratings" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>graph TD
  A[AAA] --&gt;|0.9| A
  A --&gt;|0.1| B[AA]
  B --&gt;|0.85| B
  B --&gt;|0.1| C[A]
  B --&gt;|0.05| D[Default]
  C --&gt;|0.8| C
  C --&gt;|0.2| D
  D --&gt;|1.0| D</code></pre>
<ul>
<li>AAA is the best </li>
<li>Default is an absorbing state </li>
<li>Arrows show probabilities of moving between ratings </li>
</ul>
<h3 id="stationary-distribution_1">Stationary Distribution<a class="headerlink" href="#stationary-distribution_1" title="Permanent link">&para;</a></h3>
<p>Lets solve for a stationary distribution <span class="arithmatex">\(\pi\)</span> in a 2-state example: </p>
<div class="arithmatex">\[
P =
\begin{bmatrix}
0.9 &amp; 0.1 \\
0.4 &amp; 0.6
\end{bmatrix} 
\]</div>
<p>We want: </p>
<div class="arithmatex">\[
\pi = [\pi_1, \pi_2], \quad \text{such that} \quad \pi P = \pi
\]</div>
<p>This gives: </p>
<div class="arithmatex">\[
\pi_1 = 0.9 \pi_1 + 0.4 \pi_2 \\
\pi_2 = 0.1 \pi_1 + 0.6 \pi_2 \\
\pi_1 + \pi_2 = 1
\]</div>
<p>Solving the first two yields: </p>
<div class="arithmatex">\[
\pi_1 = \frac{4}{7}, \quad \pi_2 = \frac{3}{7}
\]</div>
<h2 id="simplification">Simplification<a class="headerlink" href="#simplification" title="Permanent link">&para;</a></h2>
<h3 id="a-2-state-weather-model">A 2-State Weather Model<a class="headerlink" href="#a-2-state-weather-model" title="Permanent link">&para;</a></h3>
<p>Imagine a world where the <strong>only two weather states are</strong>:</p>
<ul>
<li>Sunny  </li>
<li>Rainy </li>
</ul>
<p>Youd told: </p>
<ul>
<li>If today is <strong>sunny</strong>, there is a <strong>70%</strong> chance tomorrow is sunny, 30% chance it will rain. </li>
<li>If today is rainy, there is a 60% chance tomorrow is rainy, a 40% chance it will be sunny. </li>
</ul>
<pre class="mermaid"><code>graph LR
S[]
R[]

S--&gt;|0.7|S
S--&gt;|0.3|R

R--&gt;|0.4|S
R--&gt;|0.6|R</code></pre>
<p>Lets say today is sunny. Lets compute: whats the probability it will be sunny in 2 days? </p>
<pre class="mermaid"><code>graph LR

S0[] --&gt;|0.7| S1[]--&gt;|0.7| S2[]
S0[] --&gt;|0.3| R1[]--&gt;|0.4| S3[]
S1[]--&gt;|0.3| R2[]
R1[]--&gt;|0.6| R3[]
</code></pre>
<p>So we have:</p>
<ul>
<li>Sunny in 2 days:<ul>
<li>0.7 x 0.7 = 0.49 </li>
<li>0.3 x 0.4 =0.12 </li>
<li>in total: 0.49 + 0.12 =0.61 </li>
</ul>
</li>
<li>Rainy in 2 days:<ul>
<li>0.7 x 0.3 =0.21 </li>
<li>0.3 x 0.6 =0.18 </li>
<li>in total: 0.21 + 0.18 =0.39 </li>
</ul>
</li>
</ul>
<p>So: </p>
<div class="arithmatex">\[
P_2(\text{Sunny}) = 0.61, 
P_2(\text{Rainy}) = 0.39
\]</div>
<p>So we can say that we are tracking how a system moves between states over time. And we are <strong>predicting the future</strong>  by using simple rules about the current state. Thats what markov chains are. </p>
<blockquote>
<p>A method of reasoning about how things change over time, assuming the next step <strong>only depends on the current one</strong>.</p>
</blockquote>
<p>This is called the Markov Property.</p>
<p>Let:</p>
<ul>
<li><span class="arithmatex">\(S_t\)</span>: the state at time <span class="arithmatex">\(t\)</span> </li>
<li><span class="arithmatex">\(P(S_{t+1} = \text{sunny} \mid S_t = \text{sunny}) = 0.7\)</span></li>
<li><span class="arithmatex">\(P(S_{t+1} = \text{rainy} \mid S_t = \text{sunny}) = 0.3\)</span> </li>
<li>Etc.</li>
</ul>
<blockquote>
<p>You only need to look at today to predict tomorrow  not the whole weeks history. </p>
</blockquote>
<h3 id="application-credit-ratings">Application: Credit Ratings<a class="headerlink" href="#application-credit-ratings" title="Permanent link">&para;</a></h3>
<p>Imagine your credit is rated:</p>
<ul>
<li>A (great)</li>
<li>B (okay)</li>
<li>D (default)</li>
</ul>
<p>Just like the weather, companies transition between credit levels: </p>
<ul>
<li>A might stay A, or fall to B </li>
<li>B might stay B, improve to A, or fall to D </li>
<li>D (default) is <strong>absorbing</strong>: once there, you stay </li>
</ul>
<p>We can now apply the same simple logic: </p>
<p>If a company is B today: </p>
<ul>
<li>50% chance stays B </li>
<li>30% chance to A </li>
<li>20% chance to D </li>
</ul>
<p>We now say, if you have: </p>
<ul>
<li><span class="arithmatex">\(n\)</span> states </li>
<li>The transition from state <span class="arithmatex">\(i\)</span> to state <span class="arithmatex">\(j\)</span> has probability <span class="arithmatex">\(P_{ij}\)</span></li>
</ul>
<p>Then after two steps: </p>
<div class="arithmatex">\[
\text{Prob(from } i \text{ to } j \text{ in 2 steps)} = \sum_k p_{ik} \cdot p_{kj}
\]</div>
<p>From <strong>state A (i)</strong> to <strong>state C (j)</strong> in <strong>2 moves</strong>. That means: First you go from <strong>A to some intermediate stabe B(k)</strong>, then from <strong>B to C</strong>.</p>
<p>the full path is: <span class="arithmatex">\(i \rightarrow k \rightarrow j\)</span> , we are just <strong>chaining together two-one-step moves</strong>.  </p>
<p>Lets say:</p>
<ul>
<li><span class="arithmatex">\(P_{ik}\)</span>: Probability to go from <strong>i to k</strong> in 1 step </li>
<li><span class="arithmatex">\(P_{kj}\)</span>: Probability to go from <strong>k to j</strong> in 1 step </li>
</ul>
<p>Then the total probability of the path: <span class="arithmatex">\(i \rightarrow k \rightarrow j\)</span> is simply: <span class="arithmatex">\(P_{ik} \cdot P_{kj}\)</span> , you multiply because these two steps are <strong>independent events</strong> happening in sequence. </p>
<p>If there isnt just one middle state <span class="arithmatex">\(k\)</span>, there could be multiple: </p>
<div class="arithmatex">\[
\begin{aligned}
i \rightarrow k_1 \rightarrow j \\
i \rightarrow k_2 \rightarrow j \\
i \rightarrow k_3 \rightarrow j \\
\text{etc}
\end{aligned}
\]</div>
<p>So to find the <strong>total probability</strong> of getting from i to j in exactly 2 steps, you must: <strong>Add up all those possible paths</strong>.</p>
<p>If you have <strong>2 total states</strong> (say, Sunny and Rainy), then the summation over k  the intermediate state  should be: </p>
<div class="arithmatex">\[
\text{Prob(2-step path from } i \text{ to } j) = \sum_{k=1}^{2} P_{ik} \cdot P_{kj} 
\]</div>
<p>Where:</p>
<ul>
<li><span class="arithmatex">\(i\)</span> is the <strong>starting state</strong></li>
<li><span class="arithmatex">\(j\)</span> is the <strong>ending state</strong></li>
<li><span class="arithmatex">\(k\)</span> runs over <strong>all possible intermediate states</strong> (1 and 2 in your case)</li>
</ul>
<p>If you had 3 states (e.g., A, B, C), then: </p>
<div class="arithmatex">\[
\sum_{k=1}^{3} P_{ik} \cdot P_{kj}
\]</div>
<p>So in general: </p>
<div class="arithmatex">\[
\text{Prob(from } i \text{ to } j \text{ in 2 steps)} = \sum_{k=1}^{n} P_{ik} \cdot P_{kj} 
\]</div>
<p>This formula is scalar-wise computing the (i,j) element of the <strong>squared transition matrix</strong>, <strong>it as a sum of path probabilities</strong>. </p>
<p>Thats just repeating what we did with sunny/rainy paths! </p>
<p>We only need a sum of multiplications. </p>
<p><strong>What happens over time?</strong> </p>
<p>If you run this process over and over (like predicting weather every day), you might find that your probability of being in each state <strong>stabilizes</strong>. </p>
<p>This stable pattern is called the <strong>stationary distribution</strong></p>
<h2 id="a-matrix-wise-intuition-for-credit-rating-as-a-markov-chain">A matrix wise intuition for Credit Rating As a Markov Chain<a class="headerlink" href="#a-matrix-wise-intuition-for-credit-rating-as-a-markov-chain" title="Permanent link">&para;</a></h2>
<pre class="mermaid"><code>graph TD
  A[A: High Grade] --&gt;|0.80| A
  A --&gt;|0.15| B[B: Medium Grade]
  A --&gt;|0.05| D[**D: Default**]
  B --&gt;|0.20| A
  B --&gt;|0.60| B
  B --&gt;|0.20| D
  D --&gt;|1.00| D</code></pre>
<p>This visual makes it clear that:</p>
<ul>
<li>A and B can both lead to D (default)</li>
<li>D loops to itself (absorbing)</li>
</ul>
<p>Lets compute the probability that a company starting in <strong>state A</strong> ends up in <strong>D (default)</strong> after <strong>3 years</strong>.</p>
<p>We list all paths from A to D in 3 steps. You can think of this like all 3-move board game paths:</p>
<p>All Possible Paths (A      D): </p>
<ol>
<li>
<p><strong>A  A  A  D</strong>:</p>
<p><span class="arithmatex">\(0.8 \times 0.8 \times 0.05 = 0.032\)</span></p>
</li>
<li>
<p><strong>A  A  B  D</strong>:</p>
<p><span class="arithmatex">\(0.8 \times 0.15 \times 0.2 = 0.024\)</span></p>
</li>
<li>
<p><strong>A  A  D  D</strong>:</p>
<p><span class="arithmatex">\(0.8 \times 0.05 \times 1 = 0.04\)</span></p>
</li>
<li>
<p><strong>A  B  B  D</strong>:</p>
<p><span class="arithmatex">\(0.15 \times 0.6 \times 0.2 = 0.018\)</span></p>
</li>
<li>
<p><strong>A  B  A  D</strong>:</p>
<p><span class="arithmatex">\(0.15 \times 0.2 \times 0.05 = 0.0015\)</span></p>
</li>
<li>
<p><strong>A  B  D  D</strong>:</p>
<p><span class="arithmatex">\(0.15 \times 0.2 \times 1 = 0.03\)</span></p>
</li>
<li>
<p><strong>A  D  D  D</strong>:</p>
<p><span class="arithmatex">\(0.05 \times 1 \times 1 = 0.05\)</span></p>
</li>
</ol>
<p>Add them ALL: <span class="arithmatex">\(P(\text{AD in 3 steps}) = 0.032 + 0.024 + 0.04 + 0.018 + 0.0015 + 0.03 + 0.05 = \boxed{0.1955}\)</span></p>
<h3 id="organize-the-probabilities-in-a-table-from-scalars-to-grid">Organize the Probabilities in a Table (From Scalars to Grid)<a class="headerlink" href="#organize-the-probabilities-in-a-table-from-scalars-to-grid" title="Permanent link">&para;</a></h3>
<p>We already used these scalar transition probabilities: </p>
<table>
<thead>
<tr>
<th><strong>From / To</strong></th>
<th><strong>A</strong></th>
<th><strong>B</strong></th>
<th><strong>D</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>A</strong></td>
<td>0.80</td>
<td>0.15</td>
<td>0.05</td>
</tr>
<tr>
<td><strong>B</strong></td>
<td>0.20</td>
<td>0.60</td>
<td>0.20</td>
</tr>
<tr>
<td><strong>D</strong></td>
<td>0.00</td>
<td>0.00</td>
<td>1.00</td>
</tr>
</tbody>
</table>
<p>This is now a <strong>transition table</strong>  a 2D grid. </p>
<h3 id="turn-that-table-into-a-transition-matrix-p">Turn That Table Into a Transition Matrix P<a class="headerlink" href="#turn-that-table-into-a-transition-matrix-p" title="Permanent link">&para;</a></h3>
<p>Now lets write the same thing using math notation: </p>
<div class="arithmatex">\[
P =
\begin{bmatrix}
0.80 &amp; 0.15 &amp; 0.05 \\
0.20 &amp; 0.60 &amp; 0.20 \\
0.00 &amp; 0.00 &amp; 1.00 \\
\end{bmatrix}
\]</div>
<p>Each row tells you: <strong>from this state</strong>, what are the chances of going to all other states. </p>
<h3 id="one-step-probability-as-a-matrix-dot-product">One-Step Probability as a Matrix Dot Product<a class="headerlink" href="#one-step-probability-as-a-matrix-dot-product" title="Permanent link">&para;</a></h3>
<p>Lets say a company is currently <strong>in state A</strong>.</p>
<p>We represent that as a <strong>vector</strong>:</p>
<div class="arithmatex">\[
\textbf{v}_0 = [1, 0, 0] \quad \text{(100\% in A, 0\% in B or D)}
\]</div>
<p>To find the probabilities <strong>after 1 year</strong>, you multiply:</p>
<div class="arithmatex">\[
\textbf{v}_1 = \textbf{v}_0 \cdot P 
\]</div>
<div class="arithmatex">\[
\textbf{v}_1 = [1, 0, 0] \cdot
\begin{bmatrix}
0.80 &amp; 0.15 &amp; 0.05 \\
0.20 &amp; 0.60 &amp; 0.20 \\
0.00 &amp; 0.00 &amp; 1.00 \\
\end{bmatrix}
= [0.80, 0.15, 0.05]
\]</div>
<p>That means:</p>
<ul>
<li>80% chance in A</li>
<li>15% chance in B</li>
<li>5% chance in D</li>
</ul>
<p>Same as the table. </p>
<h3 id="now-try-2-years-multiply-again">Now Try 2 Years  Multiply Again<a class="headerlink" href="#now-try-2-years-multiply-again" title="Permanent link">&para;</a></h3>
<p>To get the probabilities after 2 steps: </p>
<div class="arithmatex">\[
\textbf{v}_2 = \textbf{v}_1 \cdot P
= [0.80, 0.15, 0.05] \cdot P
\]</div>
<p>Were now doing exactly what you did in scalar logic  computing all the 2-step paths  but doing it much faster with matrix multiplication. </p>
<h3 id="general-rule">General Rule<a class="headerlink" href="#general-rule" title="Permanent link">&para;</a></h3>
<div class="arithmatex">\[
\textbf{v}{t} = \textbf{v}{t-1} \cdot P
\quad \text{or} \quad
\textbf{v}_t = \textbf{v}_0 \cdot P^t
\]</div>
<p>Youre simulating <strong>how the distribution of ratings evolves</strong> over time. </p>
<p>So: </p>
<div class="arithmatex">\[
\begin{aligned}
\textbf{v}_1 = \textbf{v}_0 \cdot P \\
\textbf{v}_t = \textbf{v}_0 \cdot P^t
\end{aligned}
\]</div>
<h2 id="summarization">Summarization<a class="headerlink" href="#summarization" title="Permanent link">&para;</a></h2>
<blockquote>
<p>A Markov Chain is like walking through a series of states (like credit ratings, weather, or game levels) where <strong>the only thing that matters for your next move is where you are right now</strong>  not how you got there.</p>
</blockquote>
<p>Thats called the <strong>Markov property</strong>: </p>
<div class="arithmatex">\[
P(S_{t+1} = s{\prime} \mid S_t = s, S_{t-1}, , S_0) = P(S_{t+1} = s{\prime} \mid S_t = s)
\]</div>
<p>Only the <strong>current state</strong> matters for predicting the next one. That means,  imagine your credit rating today is B. Whether you got downgraded from A or upgraded from C last year doesnt matter. All that matters is you are B now  the next step is based on that. </p>
<blockquote>
<p>RL is about learning how to act in a sequence of situations to get the best long-term reward.</p>
</blockquote>
<p>At time t:</p>
<ul>
<li><strong>State</strong>: <span class="arithmatex">\(s_t \in \mathcal{S}\)</span></li>
<li><strong>Action</strong>: <span class="arithmatex">\(a_t \in \mathcal{A}\)</span></li>
<li><strong>Reward</strong>: <span class="arithmatex">\(r_t \in \mathcal{R}\)</span></li>
<li><strong>Next State</strong>: <span class="arithmatex">\(s_{t+1} \in \mathcal{S}\)</span></li>
</ul>
<p>Goal: Find the best sequence of actions: <span class="arithmatex">\(\{a_0, a_1, \ldots, a_t, \ldots\}\)</span></p>
<p>That <strong>maximizes cumulative reward</strong> over time. This is the <strong>big picture</strong>  and Markov chains are the engine beneath the hood. </p>
<h3 id="a-2-state-homogeneous-markov-chain">A 2-State Homogeneous Markov Chain<a class="headerlink" href="#a-2-state-homogeneous-markov-chain" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>States</strong>: <span class="arithmatex">\(\mathcal{S} = \{s_1, s_2\}\)</span>, where <span class="arithmatex">\(s_1 &lt; s_2\)</span></li>
<li><strong>Transition Probabilities</strong>:<ul>
<li><span class="arithmatex">\(\mathbb{P}(S_{t+1} = s_1 | S_t = s_1) = p\)</span> </li>
<li><span class="arithmatex">\(\mathbb{P}(S_{t+1} = s_2 | S_t = s_2) = q\)</span> </li>
</ul>
</li>
</ul>
<p>The matrix is:</p>
<div class="arithmatex">\[
P = \begin{bmatrix}
p &amp; 1 - p \\
1 - q &amp; q
\end{bmatrix}
\]</div>
<p>If each state is associated with a numerical value (e.g., <span class="arithmatex">\(s_1 = -1, s_2 = 1\)</span>), then multiplying the transition matrix P by the state vector S gives us the <strong>expected value</strong> of the next state. </p>
<h2 id="code">Code<a class="headerlink" href="#code" title="Permanent link">&para;</a></h2>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">wqu.sm.markov</span><span class="w"> </span><span class="kn">import</span> <span class="n">StateMarkovChain</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Define the state</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">P</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">],</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="p">[</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">]</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">]</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="c1"># Create the Markov chain instance with initial state -1</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">mc</span> <span class="o">=</span> <span class="n">StateMarkovChain</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="n">states</span><span class="p">,</span> <span class="n">transition_matrix</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="c1"># Example 1: Simulate a two-step path</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="n">mc</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">to_state</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">path_two_steps</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1"># Example 2: Simulate a three-step path</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">mc</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">to_state</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="n">path_three_steps</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="p">(</span><span class="n">path_two_steps</span><span class="p">,</span> <span class="n">path_three_steps</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>([-1, -1, np.int64(1)], [-1, np.int64(1), np.int64(-1), np.int64(-1)])
</span></code></pre></div>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">mc</span><span class="o">.</span><span class="n">plot_trajectory</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="img" src="../assets/ECC0B232-766C-42B6-A3EF-3EC2BADEFBD4.png" /></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Simulating the stochastic process defined by: $X_t = X_{t-1} + s_t$ </span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="c1"># Initialize </span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">P</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    <span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">],</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="p">[</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">]</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="p">]</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="n">mc</span> <span class="o">=</span> <span class="n">StateMarkovChain</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="n">states</span><span class="p">,</span> <span class="n">transition_matrix</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="c1"># Simulate the process X_t = X_{t-1} + s_t for 20 steps</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="n">Xt_path</span><span class="p">,</span> <span class="n">state_path</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">simulate_X_t_process</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="p">(</span><span class="n">Xt_path</span><span class="p">,</span> <span class="n">state_path</span><span class="p">)</span>
</span></code></pre></div>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1"># Plot the simulated X_t process</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Xt_path</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X_t&#39;</span><span class="p">)</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Simulated Process $X_t = X_{t-1} + s_t$&quot;</span><span class="p">)</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time Step&quot;</span><span class="p">)</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;X_t&quot;</span><span class="p">)</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="img" src="../assets/859002D7-2911-4A55-8015-1C3223D0C0F0.png" /></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="c1"># Plot the simulated S_t process (states)</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">state_path</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;S_t&#39;</span><span class="p">)</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Simulated Process $S_t$&quot;</span><span class="p">)</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time Step&quot;</span><span class="p">)</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;S_t&quot;</span><span class="p">)</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="img" src="../assets/A4898F19-4EA6-4F8A-9EC2-EF8FE9C1E81E.png" /></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># Overlay both X_t and state values s_t on the same plot</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">time</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Xt_path</span><span class="p">)))</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="c1"># Plot X_t</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">Xt_path</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X_t&#39;</span><span class="p">)</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time Step&quot;</span><span class="p">)</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$X_t$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="c1"># Plot s_t on secondary axis</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="n">ax2</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">state_path</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;s_t (state)&#39;</span><span class="p">)</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;State $s_t$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="c1"># Legends and titles</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Process $X_t = X_{t-1} + s_t$ with Overlayed State Values $s_t$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><img alt="img" src="../assets/15D6625E-09A7-4722-9ED8-8B11AEFF776A.png" /></p>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">P</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">],</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="p">[</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">]</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="p">]</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="n">mc</span> <span class="o">=</span> <span class="n">StateMarkovChain</span><span class="p">(</span><span class="n">states</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">initial_state</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="n">X</span><span class="p">,</span> <span class="n">s_path</span><span class="p">,</span> <span class="n">Psim</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">simulate_X_t</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">75</span><span class="p">)</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="c1"># ---- Plot results ----</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;X_t (Cumulative Process)&quot;</span><span class="p">)</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s_path</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;s_t (State Transitions)&quot;</span><span class="p">)</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Empirical Transition Matrix (Psim):</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">Psim</span><span class="p">)</span>
</span></code></pre></div>
<p><img alt="xt-st-together" src="../assets/xt-st-together.png" /></p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>Empirical Transition Matrix (Psim):
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a> [[12. 14.]
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a> [13. 10.]]
</span></code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../01-index/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Reinforcement Learning">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Reinforcement Learning
              </div>
            </div>
          </a>
        
        
          
          <a href="../03-credit-ranking-example/" class="md-footer__link md-footer__link--next" aria-label="Next: Credit Ranking Markov Chain Example">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Credit Ranking Markov Chain Example
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Azat (@azataiot, azgh.cc)
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.prune", "toc.follow", "navigation.top", "search", "search.suggest", "search.highlight", "search.share", "content.tabs.link", "header.autohide", "navigation.footer", "content.code.annotate", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": {".ENV": "dotenv", "Alpine Linux": "alpinelinux", "Alpine.js": "alpinejs", "Books": "book", "CSS": "css", "Celery": "celery", "Debian": "debian", "Django": "django", "Docker": "docker", "Git": "git", "GitHub": "github", "HTML5": "html", "HTMX": "htmx", "JavaScript": "js", "PostgreSQL": "postgresql", "Postgres": "postgresql", "Python": "python", "RabbitMQ": "rabbitmq", "Redis": "redis", "Sentry": "sentry", "Shop": "shop", "Timescale": "timescale", "Ubuntu": "ubuntu"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../scripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>